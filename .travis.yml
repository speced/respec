language: node_js
dist: xenial
node_js:
  - lts/*
cache:
  directories:
    - node_modules # NPM packages
env:
  - BROWSERS=ChromeHeadless
  - BROWSERS=FirefoxHeadless

install:
  - npm install

addons:
  firefox: latest

jobs:
  include:
    - stage: Run eslint
      script:
        - npm run lint
    - stage: Run headless
      script:
        - npm run build:w3c
        - npm run test:headless
    - stage: Run Karma unit tests
      script:
        - npm run build:w3c
        - npm run build:geonovum
        - travis_retry karma start --single-run --reporters mocha karma.conf.js
